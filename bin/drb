#!/usr/bin/env ruby
# frozen_string_literal: true

require_relative "../loader"
require_relative "../clover"
require "drb/drb"

# Require each route file to add dynamic handler functions
# to the ResourceAccessor
Dir["../routes/**/*.rb"].each { |file| require file }

unless (uri = ARGV.shift)
  puts "need uri as argument"
  exit 1
end

front = ResourceAccessor
DRb.start_service(uri, front)
DRb.thread.join
